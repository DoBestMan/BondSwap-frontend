{"version":3,"sources":["dist/penpal.js"],"names":["Penpal","HANDSHAKE","HANDSHAKE_REPLY","CALL","REPLY","FULFILLED","REJECTED","MESSAGE","DATA_CLONE_ERROR","ERR_CONNECTION_DESTROYED","ERR_CONNECTION_TIMEOUT","ERR_NOT_IN_IFRAME","ERR_NO_IFRAME_SRC","createDestructor","callbacks","destroyed","[object Object]","forEach","callback","push","DEFAULT_PORTS","http:","https:","URL_REGEX","opaqueOriginSchemes","getOriginFromSrc","src","find","scheme","startsWith","location","document","regexResult","exec","protocol","hostname","port","portSuffix","createLogger","debug","_len","arguments","length","args","Array","_key","console","log","serializeError","_ref","name","message","stack","deserializeError","obj","deserializedError","Error","Object","keys","key","connectCallReceiver","info","methods","localName","local","remote","originForSending","originForReceiving","handleMessageEvent","event","source","data","penpal","origin","_event$data","methodName","id","createPromiseHandler","resolution","returnValue","returnValueIsError","postMessage","err","Promise","resolve","apply","then","addEventListener","removeEventListener","generateId","connectCallSender","callSender","methodNames","destroyConnection","createMethodProxy","iframeRemoved","closed","e","error","code","reject","reduce","api","CHECK_IFRAME_IN_DOC_INTERVAL","connectToChild","iframe","_ref$methods","childOrigin","timeout","parent","window","_createDestructor","destroy","onDestroy","srcdoc","promise","resolveConnectionPromise","connectionTimeoutId","undefined","setTimeout","receiverMethodNames","destroyCallReceiver","handleMessage","child","contentWindow","receiverMethodName","destroyCallSender","clearTimeout","checkIframeInDocIntervalId","setInterval","contains","clearInterval","connectToParent","_ref$parentOrigin","parentOrigin","top","index"],"mappings":"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"}