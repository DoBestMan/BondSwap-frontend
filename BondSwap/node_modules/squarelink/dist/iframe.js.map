{"version":3,"file":"iframe.js","sourceRoot":"","sources":["../src/iframe.js"],"names":[],"mappings":"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","sourcesContent":["import { IFRAME_URL } from './config'\n\nexport default class Iframe {\n  /**\n   * @param {string} url\n   */\n  constructor(url, params) {\n    this.url = url\n    this.params = params\n    this.open = true\n    this._createIframe()\n    this._addCloseListeners()\n    this._addMessageListeners()\n  }\n\n  close() {\n    if (!this.open) return\n    this.container.parentNode.removeChild(this.container)\n    if (this.onClosed) this.onClosed(this.error)\n    this.open = false\n  }\n\n  _addCloseListeners() {\n    this.container.addEventListener('click', () => { this.close() })\n    var self = this\n    document.onkeydown = (evt) => {\n      evt = evt || window.event\n      if (evt.keyCode == 27 && self.open) {\n        self.close()\n      }\n    }\n  }\n\n  _addMessageListeners() {\n    var self = this\n    var paramsSent = false\n    window.addEventListener('message', (e) => {\n      const { origin, height, type, error } = e.data\n      if (origin === 'squarelink-iframe') {\n        if (type === 'resize') {\n          self.iframe.style = styles.iframe(`${height}px`, 'none')\n          return\n        } else if (type === 'error') {\n          self.error = error\n          self.close()\n        } else if (type === 'onload' && !paramsSent) {\n          paramsSent = true\n          this.iframe.contentWindow.postMessage({\n            origin: 'squarelink-web3-sdk',\n            params: this.params\n          }, '*')\n        }\n      }\n    }, false)\n  }\n\n  _createIframe() {\n    /* INITIALIZE IFRAME CONTAINER */\n    const container = document.createElement('div')\n    container.id = `squarelink-iframe-container`\n    container.style = styles.container\n\n    /* INITIALIZE PRELOADER */\n    const preloader = `<div class=\"squarelink-preloader\" id=\"squarelink-preloader\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>`\n    container.innerHTML = preloader\n\n    /* INITIALIZE IFRAME */\n    const iframe = document.createElement('iframe')\n    iframe.src = `${IFRAME_URL}/?url=${encodeURI(this.url)}`\n    iframe.id = `squarelink-iframe`\n    iframe.style = styles.iframe()\n    iframe.onload = function() {\n      const pl = document.getElementById('squarelink-preloader')\n      pl.parentNode.removeChild(pl)\n    }\n    container.appendChild(iframe)\n    this.iframe = iframe\n    this.container = container\n\n    /* LOAD IFRAME CONTAINER */\n    document.body.appendChild(container)\n  }\n}\n\nconst styles = {\n  iframe: function (height='200px', border=`3px solid #fff`) {\n    return `\n      position: absolute;\n      height: ${height};\n      width: 360px;\n      top: 50%;\n      left: 50%;\n      transform:\n      translate(-50%, -50%);\n      border: 0px transparent;\n      border-radius: 10px;\n      -webkit-border-radius: 10px;\n      -moz-border-radius: 10px;\n      border-radius: 10px;\n      -khtml-border-radius: 10px;\n      border: ${border};\n      z-index: 2147483647;\n      box-shadow: 0 10px 30px 4px rgba(0,0,0,.33);\n      background: none;\n    `\n  },\n  container: `\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    z-index: 2147483647;\n    background: rgba(0,0,0,0.5);\n  `\n}\n"]}