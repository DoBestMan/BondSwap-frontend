{"version":3,"file":"popup.js","sourceRoot":"","sources":["../src/popup.js"],"names":[],"mappings":";;AAAA,mCAA6B;AAC7B,mCAAmC;AAEnC,IAAM,YAAY,GAAG,+GAA+G,CAAA;AAEpI,IAAM,QAAQ,GAAG,UAAC,EAAe;QAAb,YAAG,EAAE,kBAAM;IAC7B,8BAA8B;IAC9B,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;IAC7C,KAAK,CAAC,SAAS,GAAG,gBAAY,CAAA;IAC9B,IAAM,IAAI,GAAG,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;IACtE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;IAEvB,6BAA6B;IAC7B,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,YAAY,CAAC,CAAA;IACnD,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,IAAI,OAAO,KAAK,CAAC,MAAM,IAAE,WAAW,EAAE;QAC9D,IAAI;YAAE,KAAK,CAAC,KAAK,EAAE,CAAA;SAAE;QAAC,OAAO,GAAG,EAAE,GAAE;QACpC,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,IAAI,gBAAM,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,CAAC,CAAA;KAC5D;IACD,OAAO,UAAU,CAAC,EAAE,GAAG,KAAA,EAAE,KAAK,OAAA,EAAE,MAAM,QAAA,EAAE,CAAC,CAAA;AAC3C,CAAC,CAAA;AAED,IAAM,UAAU,GAAG,UAAC,EAAsB;QAApB,YAAG,EAAE,gBAAK,EAAE,kBAAM;IACtC,OAAA,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QAC1B,KAAK,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,CAAA;QACzB,IAAI,MAAM,GAAG,KAAK,CAAA;QAClB,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAC,CAAC;YACnC,IAAI,MAAM;gBAAE,OAAM;YACZ,IAAA,WAAyB,EAAvB,kBAAM,EAAE,cAAe,CAAA;YAC/B,IAAI,MAAM,KAAK,YAAY,IAAI,IAAI,KAAK,QAAQ,EAAE;gBAChD,MAAM,GAAG,IAAI,CAAA;gBACb,KAAK,CAAC,WAAW,CAAC,EAAE,MAAM,EAAE,qBAAqB,EAAE,MAAM,QAAA,EAAE,EAAE,GAAG,CAAC,CAAA;gBACjE,KAAK,CAAC,KAAK,EAAE,CAAA;gBACb,cAAc,CAAC,KAAK,CAAC,CAAA;gBACrB,OAAO,CAAC,EAAE,KAAK,OAAA,EAAE,CAAC,CAAA;gBAClB,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,cAAY,CAAC,CAAC,CAAA;aACrD;QACH,CAAC,EAAE,KAAK,CAAC,CAAA;IACX,CAAC,CAAC;AAfF,CAeE,CAAA;AAGJ,IAAM,cAAc,GAAG,UAAC,KAAK;IAC3B,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;IAC/C,SAAS,CAAC,EAAE,GAAG,gCAAgC,CAAA;IAC/C,SAAS,CAAC,KAAK,GAAG,uLAUjB,CAAA;IACD,0BAA0B;IAC1B,IAAM,SAAS,GAAG,2KAAuK,CAAA;IAEzL,6BAA6B;IAC7B,IAAM,WAAW,GAAG,mEAAmE,CAAA;IAEvF,SAAS,CAAC,SAAS,GAAG,WAAW,GAAG,SAAS,CAAA;IAC7C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAA;IAEpC,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE;QAC3E,KAAK,CAAC,KAAK,EAAE,CAAA;IACf,CAAC,CAAC,CAAA;AACJ,CAAC,CAAA;AAED,kBAAe,QAAQ,CAAA","sourcesContent":["import Iframe from './iframe'\nimport headerStyles from './styles'\n\nconst POPUP_PARAMS = `scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=375,height=350,left=-500,top=150`\n\nconst getPopup = ({ url, params }) => {\n  /* INITIALIZE HEADER STYLES */\n  const style = document.createElement('style')\n  style.innerHTML = headerStyles\n  const head = document.head || document.getElementsByTagName('head')[0]\n  head.appendChild(style)\n\n  /* INITIALIZE POPUP DIALOG */\n  var popup = window.open('', '_blank', POPUP_PARAMS)\n  if (!popup || popup.closed || typeof popup.closed=='undefined') {\n    try { popup.close() } catch (err) {}\n    return Promise.resolve({ iframe: new Iframe(url, params) })\n  }\n  return _loadPopup({ url, popup, params })\n}\n\nconst _loadPopup = ({ url, popup, params }) =>\n  new Promise((resolve, reject) => {\n    popup.location.href = url\n    var result = false\n    window.addEventListener('message', (e) => {\n      if (result) return\n      const { origin, type } = e.data\n      if (origin === 'squarelink' && type === 'onload') {\n        result = true\n        popup.postMessage({ origin: 'squarelink-web3-sdk', params }, '*')\n        popup.focus()\n        _addPageLoader(popup)\n        resolve({ popup })\n        window.removeEventListener('message', function() {})\n      }\n    }, false)\n  })\n\n\nconst _addPageLoader = (popup) => {\n  const container = document.createElement('div')\n  container.id = `squarelink-preloader-container`\n  container.style = `\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    z-index: 2147483647;\n    background: rgba(0,0,0,0.5);\n  `\n  /* INITIALIZE PRELOADER */\n  const preloader = `<div class=\"squarelink-preloader\" id=\"squarelink-preloader\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>`\n\n  /* INITIALIZE CLOSE BUTTON */\n  const closeButton = '<div class=\"squarelink-close\" id=\"squarelink-close-button\"></div>'\n\n  container.innerHTML = closeButton + preloader\n  document.body.appendChild(container)\n\n  document.getElementById('squarelink-close-button').addEventListener('click', () => {\n    popup.close()\n  })\n}\n\nexport default getPopup\n"]}