const test = require('tape')
const BN = require('bn.js')
const BigNumber = require('bignumber.js')
const Big = require('big.js')
const Decimal = require('decimal.js')
const { randomBytes } = require('crypto')
const toHex = require('../')

test('toHex', t => {
  t.plan(35)

  t.equal(toHex(undefined), '')
  t.equal(toHex(null), '')
  t.equal(toHex({}), '')
  t.equal(toHex(), '')
  t.equal(toHex(''), '')
  t.equal(toHex(256), '100')
  t.equal(toHex('256'), '100')
  t.equal(toHex('1e3'), '3e8')
  t.equal(toHex(256, { size: 6 }).endsWith('100'), true)
  t.equal(toHex(256, { size: 6 }).length, 6)
  t.equal(toHex(256, { addPrefix: true }), '0x100')
  t.equal(toHex(0, { addPrefix: true }), '0x0')
  t.equal(toHex('0', { addPrefix: true }), '0x0')
  t.equal(toHex('', { addPrefix: true, default: '0' }), '0x0')
  t.equal(toHex('', { addPrefix: true, default: 0 }), '0x0')
  t.equal(toHex('0', { addPrefix: true, default: '0' }), '0x0')
  t.equal(toHex('0', { addPrefix: true, default: 0 }), '0x0')
  t.equal(toHex(undefined, { addPrefix: true, default: 0 }), '0x0')
  t.equal(toHex(null, { addPrefix: true, default: 0 }), '0x0')
  t.equal(toHex('0x0100', { addPrefix: true }), '0x0100')
  t.equal(toHex('0x0100'), '0100')
  t.equal(toHex('abc'), '616263')
  t.equal(toHex('ABC'), '414243')
  t.equal(toHex('Hello world', { addPrefix: true, evenLength: true, default: '0' }), '0x48656c6c6f20776f726c64')
  t.equal(toHex(256), '100')
  t.equal(toHex(256, { evenLength: true }), '0100')
  t.equal(toHex(new BN(256)), '100')
  t.equal(toHex(new BN('100', 16)), '100')
  t.equal(toHex(new BigNumber(256)), '100')
  t.equal(toHex(new BigNumber('100', 16)), '100')
  // t.equal(toHex(new Big(256)), '100')
  t.equal(toHex(new Big('100', 16)), '100')
  // t.equal(toHex(new Decimal(256)), '100')
  t.equal(toHex(new Decimal('100', 16)), '100')
  t.equal(toHex(null, { addPrefix: true, evenLength: true, default: '0' }), '0x00')

  const bytes = randomBytes(10)
  t.equal(toHex(bytes), bytes.toString('hex'))

  const x = (n) => ({ toString: (r) => n.toString(16) })
  t.equal(toHex(x(65)), '41')
})
